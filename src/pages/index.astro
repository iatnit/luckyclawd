---
import BaseLayout from '../layouts/BaseLayout.astro';
import { SITE_TITLE, SITE_DESCRIPTION, AUTHOR } from '../consts';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog')).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
).slice(0, 5);
---

<BaseLayout description={SITE_DESCRIPTION}>
  <section>
    <h1>{SITE_TITLE}</h1>
    <p>{SITE_DESCRIPTION}</p>
  </section>

  <section>
    <h2>最新文章</h2>
    <ul class="post-list">
      {posts.map((post) => (
        <li>
          <a href={`${import.meta.env.BASE_URL}blog/${post.id}/`}>{post.data.title}</a>
          <br />
          <time datetime={post.data.pubDate.toISOString()}>
            {post.data.pubDate.toLocaleDateString('zh-CN')}
          </time>
        </li>
      ))}
    </ul>
    <p><a href={`${import.meta.env.BASE_URL}blog`}>查看全部文章 →</a></p>
  </section>
</BaseLayout>
